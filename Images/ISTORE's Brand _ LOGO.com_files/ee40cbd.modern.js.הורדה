(window.webpackJsonp=window.webpackJsonp||[]).push([[428],{1969:function(e,n,t){"use strict";t.r(n);var r=t(1),d=t(110),l=t(137),o=t(15),c=t(16),m=t.n(c);function v(){return w.apply(this,arguments)}function w(){return w=Object(r.a)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(o.a.debug("Handling UserSignup UTM params"),e>30)throw new Error("Failed to set up user");e++,yield new Promise((e=>setTimeout(e,1e3)));var n=window.$nuxt.$api;if(n){var t={utm_source:m.a.get("utm_source")||"empty",utm_medium:m.a.get("utm_medium")||"(not set)",utm_campaign:m.a.get("utm_campaign")||void 0,currency:m.a.get("currency")||null,language:m.a.get("language")||void 0};if(0!==Object.keys(t).length)try{yield n.patch("/api/v3/users/me",t)}catch(n){if(!n.response)throw n;if(404===n.response.status)return v(e)}}})),w.apply(this,arguments)}l.a.$on(d.a.UserSignedIn,(e=>{var n,t,{user:r,method:c,enterprise:v,track_analytics:w=!0}=e;(o.a.debug("Handling UserSignedIn",r),w&&l.a.$emit(d.a.AnalyticsGA4Event,{event:"login",userId:r.id,method:c}),null===(n=window.$nuxt)||void 0===n||null===(t=n.$sentry)||void 0===t||t.setUser({id:r.id,email:r.email}),v.is_whitelabel)||(m.a.get("currency")!==r.currency&&(m.a.set("currency",r.currency),l.a.$emit(d.a.CurrencyChange,r.currency)),m.a.remove("unauthed_cart"))})),l.a.$on(d.a.UserRegistered,function(){var e=Object(r.a)((function*(e){var n,t,{user:r,method:c,enterprise:w}=e;o.a.debug("Handling UserRegistered",r),v().catch((e=>o.a.error(e))),l.a.$emit(d.a.AnalyticsGA4Event,{event:"sign_up",userId:r.id,method:c}),null===(n=window.$nuxt)||void 0===n||null===(t=n.$sentry)||void 0===t||t.setUser({id:r.id,email:r.email}),m.a.remove("unauthed_cart"),w.is_whitelabel}));return function(n){return e.apply(this,arguments)}}()),l.a.$on(d.a.UserUpdatedAttributes,(e=>{var n,t,{user:r,enterprise:d}=e;o.a.debug("Handling UserUpdatedAttributes",r),m.a.remove("unauthed_cart"),d.is_whitelabel||(r.given_name||r.family_name)&&(null===(n=window.$nuxt)||void 0===n||null===(t=n.$sentry)||void 0===t||t.setUser({id:r.id,email:r.email}))})),l.a.$on(d.a.UserSignedOut,(e=>{var n,t,{enterprise:r}=e;o.a.debug("Handling UserSignedOut"),null===(n=window.$nuxt)||void 0===n||null===(t=n.$sentry)||void 0===t||t.setUser(null),r.is_whitelabel}))}}]);
//# sourceMappingURL=ee40cbd.modern.js.map